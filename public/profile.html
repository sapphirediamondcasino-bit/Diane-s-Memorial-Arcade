<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - Diane Keaton Memorial Arcade</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --neon-blue: #00f3ff;
            --neon-purple: #bf00ff;
            --neon-pink: #ff00ff;
            --neon-green: #39ff14;
            --dark-bg: #050510;
            --darker: #020208;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background: var(--dark-bg);
            color: white;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: 
                linear-gradient(90deg, transparent 49%, rgba(0, 243, 255, 0.1) 50%, transparent 51%),
                linear-gradient(0deg, transparent 49%, rgba(0, 243, 255, 0.1) 50%, transparent 51%);
            background-size: 50px 50px;
            z-index: -1;
            animation: gridMove 20s linear infinite;
        }
        
        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }
        
        .nav-bar {
            position: sticky;
            top: 0;
            background: rgba(5, 5, 16, 0.98);
            backdrop-filter: blur(30px);
            padding: 20px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid var(--neon-blue);
            box-shadow: 0 5px 40px rgba(0, 243, 255, 0.4);
            z-index: 2000;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .nav-brand {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5em;
            font-weight: 900;
            color: var(--neon-blue);
            text-shadow: 0 0 20px var(--neon-blue);
            letter-spacing: 2px;
        }
        
        .nav-links {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
        }
        
        .nav-link {
            font-family: 'Orbitron', sans-serif;
            color: white;
            text-decoration: none;
            padding: 12px 28px;
            border: 2px solid var(--neon-blue);
            border-radius: 30px;
            transition: all 0.3s;
            font-weight: 700;
            letter-spacing: 1px;
            font-size: 0.9em;
        }
        
        .nav-link:hover {
            background: var(--neon-blue);
            color: var(--darker);
            box-shadow: 0 0 30px var(--neon-blue);
            transform: translateY(-3px);
        }
        
        .logout-btn {
            background: linear-gradient(135deg, var(--neon-purple), var(--neon-pink));
            border: none;
            box-shadow: 0 0 25px var(--neon-purple);
            cursor: pointer;
        }
        
        .container {
            max-width: 1600px;
            margin: 60px auto;
            padding: 0 40px;
        }
        
        .profile-banner {
            position: relative;
            height: 300px;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            border-radius: 30px 30px 0 0;
            overflow: hidden;
            border: 3px solid var(--neon-blue);
            border-bottom: none;
        }
        
        .banner-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .banner-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent, rgba(5, 5, 16, 0.8));
        }
        
        .edit-banner-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 12px 30px;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            border: 2px solid var(--neon-blue);
            border-radius: 25px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 10;
        }
        
        .edit-banner-btn:hover {
            background: var(--neon-blue);
            color: var(--darker);
            box-shadow: 0 0 30px var(--neon-blue);
        }
        
        .profile-header {
            background: rgba(5, 5, 16, 0.95);
            border: 3px solid var(--neon-blue);
            border-top: none;
            border-radius: 0 0 30px 30px;
            padding: 50px;
            margin-bottom: 40px;
            box-shadow: 0 0 60px rgba(0, 243, 255, 0.4);
            display: flex;
            align-items: flex-start;
            gap: 50px;
            flex-wrap: wrap;
            position: relative;
            margin-top: -100px;
        }
        
        .avatar-container {
            position: relative;
            margin-top: -80px;
        }
        
        .profile-avatar {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            border: 5px solid var(--neon-blue);
            box-shadow: 0 0 60px var(--neon-blue);
            object-fit: cover;
            animation: avatarGlow 3s ease infinite;
            background: var(--darker);
        }
        
        @keyframes avatarGlow {
            0%, 100% { box-shadow: 0 0 60px var(--neon-blue); }
            50% { box-shadow: 0 0 100px var(--neon-blue), 0 0 140px var(--neon-purple); }
        }
        
        .edit-avatar-btn {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--neon-blue);
            border: 3px solid var(--darker);
            color: var(--darker);
            font-size: 1.5em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .edit-avatar-btn:hover {
            background: var(--neon-purple);
            transform: scale(1.1);
            box-shadow: 0 0 30px var(--neon-purple);
        }
        
        .profile-info {
            flex: 1;
            padding-top: 20px;
        }
        
        .profile-username {
            font-family: 'Orbitron', sans-serif;
            font-size: 3em;
            font-weight: 900;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
        }
        
        .profile-badges {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .badge-icon {
            font-size: 2em;
            padding: 8px;
            background: rgba(0, 243, 255, 0.1);
            border: 2px solid var(--neon-blue);
            border-radius: 12px;
            cursor: help;
            transition: all 0.3s;
        }
        
        .badge-icon:hover {
            transform: scale(1.2);
            box-shadow: 0 0 20px var(--neon-blue);
        }
        
        .admin-badge {
            display: inline-block;
            padding: 8px 20px;
            background: linear-gradient(135deg, #ffd700, #ff6600);
            border-radius: 20px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            color: #000;
            margin-left: 15px;
            box-shadow: 0 0 30px #ffd700;
        }
        
        .profile-level {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5em;
            color: var(--neon-green);
            margin-bottom: 20px;
            text-shadow: 0 0 20px var(--neon-green);
        }
        
        .xp-bar-container {
            width: 100%;
            max-width: 500px;
            height: 40px;
            background: rgba(0, 243, 255, 0.1);
            border: 2px solid var(--neon-blue);
            border-radius: 20px;
            overflow: hidden;
            margin: 20px 0;
            position: relative;
        }
        
        .xp-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
            border-radius: 20px;
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            box-shadow: 0 0 30px var(--neon-blue);
            position: relative;
            z-index: 2;
        }
        
        .xp-text {
            position: absolute;
            width: 100%;
            text-align: center;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            z-index: 3;
            color: white;
            text-shadow: 0 0 10px #000;
        }
        
        .profile-stats {
            display: flex;
            gap: 30px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .stat-item {
            text-align: center;
            background: rgba(0, 243, 255, 0.05);
            padding: 15px 25px;
            border-radius: 15px;
            border: 2px solid rgba(0, 243, 255, 0.3);
        }
        
        .stat-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 2em;
            font-weight: 900;
            color: var(--neon-blue);
            text-shadow: 0 0 20px var(--neon-blue);
            display: block;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .section-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5em;
            font-weight: 900;
            text-align: center;
            margin: 60px 0 40px;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .section-title::after {
            content: '';
            display: block;
            width: 150px;
            height: 4px;
            background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
            margin: 20px auto;
            border-radius: 10px;
            box-shadow: 0 0 20px var(--neon-blue);
        }
        
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 60px;
        }
        
        .achievement-card {
            background: rgba(5, 5, 16, 0.85);
            border: 2px solid var(--neon-purple);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s;
            position: relative;
        }
        
        .achievement-card.locked {
            opacity: 0.3;
            filter: grayscale(100%);
        }
        
        .achievement-card:not(.locked):hover {
            transform: scale(1.05);
            box-shadow: 0 0 50px var(--neon-purple);
        }
        
        .achievement-icon {
            font-size: 4em;
            margin-bottom: 15px;
        }
        
        .achievement-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3em;
            font-weight: 900;
            color: var(--neon-purple);
            margin-bottom: 10px;
        }
        
        .achievement-desc {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .achievement-rewards {
            margin-top: 10px;
            color: var(--neon-green);
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
        }
        
        .lock-icon {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5em;
        }
        
        .friends-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 25px;
            margin-bottom: 60px;
        }
        
        .friend-card {
            background: rgba(5, 5, 16, 0.85);
            border: 2px solid var(--neon-blue);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .friend-card:hover {
            transform: scale(1.05);
            box-shadow: 0 0 40px var(--neon-blue);
        }
        
        .friend-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid var(--neon-blue);
            margin: 0 auto 15px;
            object-fit: cover;
        }
        
        .friend-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2em;
            color: var(--neon-blue);
            margin-bottom: 8px;
        }
        
        .friend-level {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal.active { display: flex; }
        
        .modal-content {
            background: rgba(5, 5, 16, 0.98);
            border: 3px solid var(--neon-blue);
            border-radius: 30px;
            padding: 50px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        
        .modal-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2em;
            font-weight: 900;
            color: var(--neon-blue);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--neon-pink);
            border: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .close-modal:hover {
            transform: rotate(90deg) scale(1.1);
        }
        
        .avatar-grid, .banner-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .option-item {
            aspect-ratio: 1;
            border: 3px solid var(--neon-blue);
            border-radius: 15px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        
        .option-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .option-item:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px var(--neon-blue);
        }
        
        .option-item.selected {
            border-color: var(--neon-green);
            box-shadow: 0 0 30px var(--neon-green);
        }
        
        .option-item.selected::after {
            content: '✓';
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--neon-green);
            color: var(--darker);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
        }
        
        .file-upload-section {
            background: rgba(0, 243, 255, 0.05);
            border: 2px dashed var(--neon-blue);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .file-upload-section input[type="file"] {
            display: none;
        }
        
        .upload-label {
            display: inline-block;
            padding: 15px 40px;
            background: var(--neon-blue);
            color: var(--darker);
            border-radius: 30px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .upload-label:hover {
            box-shadow: 0 0 30px var(--neon-blue);
            transform: scale(1.05);
        }
        
        .save-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            border: none;
            border-radius: 50px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .save-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 50px rgba(0, 243, 255, 0.8);
        }
        
        .notification {
            position: fixed;
            bottom: -100px;
            right: 30px;
            padding: 20px 30px;
            background: var(--neon-blue);
            color: var(--darker);
            border-radius: 10px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            z-index: 20000;
            transition: bottom 0.3s;
            box-shadow: 0 0 40px var(--neon-blue);
        }
        
        .notification.show {
            bottom: 30px;
        }
        
        .notification.error {
            background: var(--neon-pink);
        }
        
        .notification.success {
            background: var(--neon-green);
        }
        
        @media (max-width: 768px) {
            .profile-header { flex-direction: column; text-align: center; padding: 30px; }
            .avatar-container { margin-top: -120px; }
            .profile-username { font-size: 2em; }
            .achievements-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <nav class="nav-bar">
        <div class="nav-brand">🎮 MY PROFILE</div>
        <div class="nav-links">
            <a href="index.html" class="nav-link">HOME</a>
            <a href="shop.html" class="nav-link">COIN SHOP 🪙</a>
            <a href="achievements.html" class="nav-link">ACHIEVEMENTS</a>
            <a href="leaderboard.html" class="nav-link">LEADERBOARD</a>
            <a href="movies.html" class="nav-link">MOVIES 🎬</a>
            <a href="bot.html" class="nav-link">DIANE BOT 🤖</a>
            <a href="Settings.html" class="nav-link">SETTINGS ⚙️</a>
            <button class="nav-link logout-btn" onclick="logout()">LOGOUT</button>
        </div>
    </nav>
    
    <div class="container">
        <div class="profile-banner">
            <img src="" alt="Banner" class="banner-image" id="profile-banner">
            <div class="banner-overlay"></div>
            <button class="edit-banner-btn" onclick="openBannerModal()">✏️ CHANGE BANNER</button>
        </div>
        
        <div class="profile-header">
            <div class="avatar-container">
                <img src="" alt="Avatar" class="profile-avatar" id="user-avatar">
                <button class="edit-avatar-btn" onclick="openAvatarModal()">✏️</button>
            </div>
            <div class="profile-info">
                <h1 class="profile-username" id="username">LOADING...</h1>
                <div class="profile-badges" id="user-badges"></div>
                <div class="profile-level">⚡ LEVEL <span id="user-level">1</span></div>
                <div class="xp-bar-container">
                    <div class="xp-bar" id="xp-bar" style="width: 0%"></div>
                    <div class="xp-text" id="xp-text">0 / 100 XP</div>
                </div>
                
                <div class="profile-stats">
                    <div class="stat-item">
                        <span class="stat-value" id="stat-achievements">0</span>
                        <div class="stat-label">🏆 Achievements</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-games">0</span>
                        <div class="stat-label">🎮 Games Played</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-coins">0</span>
                        <div class="stat-label">🪙 Coins</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-friends">0</span>
                        <div class="stat-label">👥 Friends</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-joined">Loading...</span>
                        <div class="stat-label">📅 Member Since</div>
                    </div>
                </div>
            </div>
        </div>
        
        <h2 class="section-title">🏆 MY ACHIEVEMENTS</h2>
        <div class="achievements-grid" id="achievements-container"></div>
        
        <h2 class="section-title">👥 MY FRIENDS</h2>
        <div class="friends-grid" id="friends-container"></div>
    </div>

    <!-- Avatar Modal -->
    <div class="modal" id="avatar-modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('avatar-modal')">×</button>
            <h2 class="modal-title">CHOOSE AVATAR</h2>
            
            <div class="file-upload-section">
                <h3 style="margin-bottom: 15px; color: var(--neon-blue);">Upload Custom Image</h3>
                <input type="file" id="avatar-file-input" accept="image/*" onchange="handleAvatarFileUpload(event)">
                <label for="avatar-file-input" class="upload-label">📤 UPLOAD IMAGE</label>
                <p style="margin-top: 15px; opacity: 0.7; font-size: 0.9em;">Max 5MB • JPG, PNG, GIF, WEBP</p>
            </div>
            
            <h3 style="text-align: center; margin-bottom: 20px; color: var(--neon-purple);">Or Choose from Presets</h3>
            <div class="avatar-grid" id="avatar-options"></div>
            <button class="save-btn" onclick="saveAvatar()">💾 SAVE AVATAR</button>
        </div>
    </div>

    <!-- Banner Modal -->
    <div class="modal" id="banner-modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('banner-modal')">×</button>
            <h2 class="modal-title">CHOOSE BANNER</h2>
            
            <div class="file-upload-section">
                <h3 style="margin-bottom: 15px; color: var(--neon-blue);">Upload Custom Image</h3>
                <input type="file" id="banner-file-input" accept="image/*" onchange="handleBannerFileUpload(event)">
                <label for="banner-file-input" class="upload-label">📤 UPLOAD IMAGE</label>
                <p style="margin-top: 15px; opacity: 0.7; font-size: 0.9em;">Max 5MB • JPG, PNG, GIF, WEBP</p>
            </div>
            
            <h3 style="text-align: center; margin-bottom: 20px; color: var(--neon-purple);">Or Choose from Presets</h3>
            <div class="banner-grid" id="banner-options"></div>
            <button class="save-btn" onclick="saveBanner()">💾 SAVE BANNER</button>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        let currentUser = null;
        let selectedAvatar = null;
        let selectedBanner = null;
        let uploadedAvatarFile = null;
        let uploadedBannerFile = null;
        
        // 50+ Avatar Presets
        const avatarPresets = [
            'https://api.dicebear.com/7.x/avataaars/svg?seed=felix',
            'https://api.dicebear.com/7.x/avataaars/svg?seed=aneka',
            'https://api.dicebear.com/7.x/avataaars/svg?seed=luna',
            'https://api.dicebear.com/7.x/avataaars/svg?seed=max',
            'https://api.dicebear.com/7.x/avataaars/svg?seed=charlie',
            'https://api.dicebear.com/7.x/avataaars/svg?seed=milo',
            'https://api.dicebear.com/7.x/avataaars/svg?seed=leo',
            'https://api.dicebear.com/7.x/avataaars/svg?seed=shadow',
            'https://api.dicebear.com/7.x/avataaars/svg?seed=tiger',
            'https://api.dicebear.com/7.x/avataaars/svg?seed=bear',
            'https://api.dicebear.com/7.x/bottts/svg?seed=robot1',
            'https://api.dicebear.com/7.x/bottts/svg?seed=robot2',
            'https://api.dicebear.com/7.x/bottts/svg?seed=robot3',
            'https://api.dicebear.com/7.x/bottts/svg?seed=cyborg',
            'https://api.dicebear.com/7.x/bottts/svg?seed=android',
            'https://api.dicebear.com/7.x/personas/svg?seed=person1',
            'https://api.dicebear.com/7.x/personas/svg?seed=person2',
            'https://api.dicebear.com/7.x/personas/svg?seed=person3',
            'https://api.dicebear.com/7.x/personas/svg?seed=person4',
            'https://api.dicebear.com/7.x/personas/svg?seed=person5',
            'https://api.dicebear.com/7.x/adventurer/svg?seed=hero1',
            'https://api.dicebear.com/7.x/adventurer/svg?seed=hero2',
            'https://api.dicebear.com/7.x/adventurer/svg?seed=hero3',
            'https://api.dicebear.com/7.x/adventurer/svg?seed=warrior',
            'https://api.dicebear.com/7.x/adventurer/svg?seed=knight',
            'https://api.dicebear.com/7.x/big-smile/svg?seed=smile1',
            'https://api.dicebear.com/7.x/big-smile/svg?seed=smile2',
            'https://api.dicebear.com/7.x/big-smile/svg?seed=happy',
            'https://api.dicebear.com/7.x/big-smile/svg?seed=joy',
            'https://api.dicebear.com/7.x/big-smile/svg?seed=cheerful',
            'https://api.dicebear.com/7.x/fun-emoji/svg?seed=emoji1',
            'https://api.dicebear.com/7.x/fun-emoji/svg?seed=emoji2',
            'https://api.dicebear.com/7.x/fun-emoji/svg?seed=emoji3',
            'https://api.dicebear.com/7.x/fun-emoji/svg?seed=cool',
            'https://api.dicebear.com/7.x/fun-emoji/svg?seed=awesome',
            'https://api.dicebear.com/7.x/lorelei/svg?seed=lorelei1',
            'https://api.dicebear.com/7.x/lorelei/svg?seed=lorelei2',
            'https://api.dicebear.com/7.x/lorelei/svg?seed=lorelei3',
            'https://api.dicebear.com/7.x/miniavs/svg?seed=mini1',
            'https://api.dicebear.com/7.x/miniavs/svg?seed=mini2',
            'https://api.dicebear.com/7.x/miniavs/svg?seed=mini3',
            'https://api.dicebear.com/7.x/pixel-art/svg?seed=pixel1',
            'https://api.dicebear.com/7.x/pixel-art/svg?seed=pixel2',
            'https://api.dicebear.com/7.x/pixel-art/svg?seed=retro',
            'https://api.dicebear.com/7.x/pixel-art/svg?seed=arcade',
            'https://api.dicebear.com/7.x/pixel-art/svg?seed=8bit',
            'https://api.dicebear.com/7.x/thumbs/svg?seed=thumb1',
            'https://api.dicebear.com/7.x/thumbs/svg?seed=thumb2',
            'https://api.dicebear.com/7.x/identicon/svg?seed=id1',
            'https://api.dicebear.com/7.x/identicon/svg?seed=id2',
            'https://api.dicebear.com/7.x/shapes/svg?seed=shape1'
        ];
        
        // 50+ Banner Presets
        const bannerPresets = [
            'https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1511512578047-dfb367046420?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1538481199705-c710c4e965fc?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1542751371-adc38448a05e?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1579546929518-9e396f3cc809?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1557683316-973673baf926?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1557682250-33bd709cbe85?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1557682224-5b8590cd9ec5?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1519681393784-d120267933ba?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1476514525535-07fb3b4ae5f1?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1518837695005-2083093ee35b?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1472214103451-9374bd1c798e?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1475924156734-496f6cac6ec1?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1493246507139-91e8fad9978e?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1470252649378-9c29740c9fa8?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1502082553048-f009c37129b9?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1465146344425-f00d5f5c8f07?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1482192505345-5655af888cc4?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1426604966848-d7adac402bff?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1504893524553-b855bce32c67?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1418065460487-3e41a6c84dc5?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1501594907352-04cda38ebc29?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1484600899469-230e8d1d59c0?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1505142468610-359e7d316be0?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1496747611176-843222e1e57c?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1492144534655-ae79c964c9d7?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1488229297570-58520851e868?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1485470733090-0aae1788d5af?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1495954484750-af469f2f9be5?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1500534314209-a25ddb2bd429?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1475274047050-1d0c0975c63e?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1506260408121-e353d10b87c7?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1483086431886-3590a88317fe?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1434725039720-aaad6dd32dfe?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1447752875215-b2761acb3c5d?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1444927714506-8492d94b4e3d?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1478827387698-1527781a4887?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1499346030926-9a72daac6c63?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1534447677768-be436bb09401?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1504198266287-1659872e6590?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1509114397022-ed747cca3f65?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1520637836993-a071674ec67b?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1528183429752-a97d0bf99b5a?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1533460004989-cef01064af7e?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1560015534-cee980ba7e13?w=1200&h=400&fit=crop'
        ];
        
        async function loadProfile() {
            try {
                const response = await fetch('/api/user');
                if (!response.ok) {
                    window.location.href = '/';
                    return;
                }
                
                currentUser = await response.json();
                
                // Update profile display
                document.getElementById('username').textContent = currentUser.username.toUpperCase();
                document.getElementById('user-level').textContent = currentUser.level;
                document.getElementById('user-avatar').src = currentUser.avatar_url || avatarPresets[0];
                document.getElementById('profile-banner').src = currentUser.banner_url || bannerPresets[0];
                
                // Display badges
                const badgesContainer = document.getElementById('user-badges');
                if (currentUser.badges && currentUser.badges.length > 0) {
                    const badgeIcons = {
                        'verified_discord': '🔷',
                        'org_badge': '🏢',
                        'roblox_badge': '🎮',
                        'premium_badge': '💎',
                        'founder_badge': '👑'
                    };
                    badgesContainer.innerHTML = currentUser.badges.map(badge => 
                        `<span class="badge-icon" title="${badge.badge_id}">${badgeIcons[badge.badge_id] || '🏅'}</span>`
                    ).join('');
                }
                
                // Show admin badge
                if (currentUser.is_admin) {
                    badgesContainer.innerHTML += '<span class="admin-badge">👑 ADMIN</span>';
                }
                
                // Update stats
                document.getElementById('stat-coins').textContent = (currentUser.coins || 0).toLocaleString();
                document.getElementById('stat-games').textContent = currentUser.total_games_played || 0;
                document.getElementById('stat-joined').textContent = currentUser.join_date || 'Unknown';
                
                // XP Bar
                const xpNeeded = Math.pow(currentUser.level, 2) * 100;
                const xpProgress = Math.min(((currentUser.xp % xpNeeded) / xpNeeded) * 100, 100);
                document.getElementById('xp-bar').style.width = xpProgress + '%';
                document.getElementById('xp-text').textContent = `${currentUser.xp} / ${xpNeeded} XP`;
                
                // Load achievements
                await loadAchievements();
                
                // Load friends
                await loadFriends();
                
            } catch (error) {
                console.error('Failed to load profile:', error);
                showNotification('Failed to load profile', 'error');
            }
        }
        
        async function loadAchievements() {
            try {
                const response = await fetch('/api/user/achievements');
                const achievements = await response.json();
                
                const container = document.getElementById('achievements-container');
                const unlockedCount = achievements.filter(a => a.unlocked).length;
                document.getElementById('stat-achievements').textContent = unlockedCount;
                
                // Show only first 12 achievements on profile
                const displayAchievements = achievements.slice(0, 12);
                
                container.innerHTML = displayAchievements.map(ach => `
                    <div class="achievement-card ${ach.unlocked ? '' : 'locked'}">
                        ${!ach.unlocked ? '<div class="lock-icon">🔒</div>' : ''}
                        <div class="achievement-icon">${ach.icon}</div>
                        <div class="achievement-name">${ach.name}</div>
                        <div class="achievement-desc">${ach.description}</div>
                        <div class="achievement-rewards">+${ach.xp_reward} XP • +${ach.coins_reward} 🪙</div>
                        ${ach.unlocked ? `<div style="margin-top: 10px; font-size: 0.8em; opacity: 0.7;">Unlocked ${new Date(ach.unlocked_at).toLocaleDateString()}</div>` : ''}
                    </div>
                `).join('');
                
                if (achievements.length > 12) {
                    container.innerHTML += `
                        <div class="achievement-card" style="display: flex; align-items: center; justify-content: center; cursor: pointer; background: rgba(191, 0, 255, 0.1);" onclick="window.location.href='achievements.html'">
                            <div style="text-align: center;">
                                <div style="font-size: 3em; margin-bottom: 15px;">🏆</div>
                                <div class="achievement-name">View All Achievements</div>
                                <div class="achievement-desc">${achievements.length} total achievements</div>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Failed to load achievements:', error);
            }
        }
        
        async function loadFriends() {
            try {
                const response = await fetch('/api/friends');
                const friends = await response.json();
                
                const container = document.getElementById('friends-container');
                document.getElementById('stat-friends').textContent = friends.length;
                
                if (friends.length === 0) {
                    container.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 60px; background: rgba(191, 0, 255, 0.1); border: 2px dashed var(--neon-purple); border-radius: 20px;">
                            <div style="font-size: 4em; margin-bottom: 20px;">👥</div>
                            <h3 style="font-family: 'Orbitron', sans-serif; color: var(--neon-purple); margin-bottom: 15px;">No Friends Yet</h3>
                            <p style="opacity: 0.8;">Add friends to compete and compare stats!</p>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = friends.map(friend => `
                    <div class="friend-card" onclick="viewProfile('${friend.id}')">
                        <img src="${friend.avatar_url || avatarPresets[0]}" alt="${friend.username}" class="friend-avatar">
                        <div class="friend-name">${friend.username}</div>
                        <div class="friend-level">Level ${friend.level}</div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Failed to load friends:', error);
            }
        }
        
        function openAvatarModal() {
            const modal = document.getElementById('avatar-modal');
            const container = document.getElementById('avatar-options');
            
            container.innerHTML = avatarPresets.map((url, index) => `
                <div class="option-item ${currentUser.avatar_url === url ? 'selected' : ''}" onclick="selectAvatar('${url}')">
                    <img src="${url}" alt="Avatar ${index + 1}">
                </div>
            `).join('');
            
            modal.classList.add('active');
        }
        
        function openBannerModal() {
            const modal = document.getElementById('banner-modal');
            const container = document.getElementById('banner-options');
            
            container.innerHTML = bannerPresets.map((url, index) => `
                <div class="option-item ${currentUser.banner_url === url ? 'selected' : ''}" onclick="selectBanner('${url}')">
                    <img src="${url}" alt="Banner ${index + 1}">
                </div>
            `).join('');
            
            modal.classList.add('active');
        }
        
        function selectAvatar(url) {
            selectedAvatar = url;
            uploadedAvatarFile = null;
            document.querySelectorAll('#avatar-options .option-item').forEach(el => el.classList.remove('selected'));
            event.target.closest('.option-item').classList.add('selected');
        }
        
        function selectBanner(url) {
            selectedBanner = url;
            uploadedBannerFile = null;
            document.querySelectorAll('#banner-options .option-item').forEach(el => el.classList.remove('selected'));
            event.target.closest('.option-item').classList.add('selected');
        }
        
        function handleAvatarFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.size > 5 * 1024 * 1024) {
                showNotification('File too large! Max 5MB', 'error');
                return;
            }
            
            uploadedAvatarFile = file;
            selectedAvatar = null;
            document.querySelectorAll('#avatar-options .option-item').forEach(el => el.classList.remove('selected'));
            showNotification('File selected! Click SAVE to upload', 'success');
        }
        
        function handleBannerFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.size > 5 * 1024 * 1024) {
                showNotification('File too large! Max 5MB', 'error');
                return;
            }
            
            uploadedBannerFile = file;
            selectedBanner = null;
            document.querySelectorAll('#banner-options .option-item').forEach(el => el.classList.remove('selected'));
            showNotification('File selected! Click SAVE to upload', 'success');
        }
        
        async function saveAvatar() {
            try {
                if (uploadedAvatarFile) {
                    // Upload custom file
                    const formData = new FormData();
                    formData.append('avatar', uploadedAvatarFile);
                    
                    const response = await fetch('/api/user/avatar', {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!response.ok) throw new Error('Upload failed');
                    
                    const data = await response.json();
                    currentUser.avatar_url = data.avatar_url;
                } else if (selectedAvatar) {
                    // Use preset - save URL directly
                    const response = await fetch('/api/user/avatar-preset', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ avatar_url: selectedAvatar })
                    });
                    
                    if (!response.ok) throw new Error('Save failed');
                    
                    currentUser.avatar_url = selectedAvatar;
                } else {
                    showNotification('Please select an avatar or upload a file', 'error');
                    return;
                }
                
                document.getElementById('user-avatar').src = currentUser.avatar_url;
                closeModal('avatar-modal');
                showNotification('Avatar updated!', 'success');
            } catch (error) {
                console.error('Avatar save error:', error);
                showNotification('Failed to save avatar', 'error');
            }
        }
        
        async function saveBanner() {
            try {
                if (uploadedBannerFile) {
                    // Upload custom file
                    const formData = new FormData();
                    formData.append('banner', uploadedBannerFile);
                    
                    const response = await fetch('/api/user/banner', {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!response.ok) throw new Error('Upload failed');
                    
                    const data = await response.json();
                    currentUser.banner_url = data.banner_url;
                } else if (selectedBanner) {
                    // Use preset - save URL directly
                    const response = await fetch('/api/user/banner-preset', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ banner_url: selectedBanner })
                    });
                    
                    if (!response.ok) throw new Error('Save failed');
                    
                    currentUser.banner_url = selectedBanner;
                } else {
                    showNotification('Please select a banner or upload a file', 'error');
                    return;
                }
                
                document.getElementById('profile-banner').src = currentUser.banner_url;
                closeModal('banner-modal');
                showNotification('Banner updated!', 'success');
            } catch (error) {
                console.error('Banner save error:', error);
                showNotification('Failed to save banner', 'error');
            }
        }
        
        function viewProfile(userId) {
            // TODO: View other user's profile
            showNotification('Viewing other profiles coming soon!', 'info');
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            selectedAvatar = null;
            selectedBanner = null;
            uploadedAvatarFile = null;
            uploadedBannerFile = null;
        }
        
        async function logout() {
            try {
                await fetch('/api/logout', { method: 'POST' });
                window.location.href = '/';
            } catch (error) {
                console.error('Logout error:', error);
            }
        }
        
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }
        
        // Load profile on page load
        loadProfile();
    </script>
</body>
</html>